\hypertarget{group__generalized__sc}{\section{Generalized Soft Constraints}
\label{group__generalized__sc}\index{Generalized Soft Constraints@{Generalized Soft Constraints}}
}
Collaboration diagram for Generalized Soft Constraints\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=348pt]{group__generalized__sc}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__generalized__sc_ga8bd41ebc8039378d242e4e8c273716a5}{\#define \hyperlink{group__generalized__sc_ga8bd41ebc8039378d242e4e8c273716a5}{V\-R\-N\-A\-\_\-\-D\-E\-C\-O\-M\-P\-\_\-\-P\-A\-I\-R\-\_\-\-H\-P}~1}\label{group__generalized__sc_ga8bd41ebc8039378d242e4e8c273716a5}

\begin{DoxyCompactList}\small\item\em Generalized constraint folding flag indicating hairpin loop decomposition step. \end{DoxyCompactList}\item 
\hypertarget{group__generalized__sc_gaeab04f34d7730cff2d651d782f95d857}{\#define \hyperlink{group__generalized__sc_gaeab04f34d7730cff2d651d782f95d857}{V\-R\-N\-A\-\_\-\-D\-E\-C\-O\-M\-P\-\_\-\-P\-A\-I\-R\-\_\-\-I\-L}~2}\label{group__generalized__sc_gaeab04f34d7730cff2d651d782f95d857}

\begin{DoxyCompactList}\small\item\em Generalized constraint folding flag indicating interior loop decomposition step. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef int( \hyperlink{group__generalized__sc_ga2f3d2d2333e5a616e0f5cd4823780c0c}{vrna\-\_\-callback\-\_\-sc\-\_\-energy} )(int i, int j, int k, int l, char d, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback to retrieve pseudo energy contribution for soft constraint feature. \end{DoxyCompactList}\item 
typedef \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L}( \hyperlink{group__generalized__sc_ga28d5138cc47eb7a5116c87518fd076a9}{vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy} )(int i, int j, int k, int l, char d, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback to retrieve pseudo energy contribution as Boltzmann Factors for soft constraint feature. \end{DoxyCompactList}\item 
typedef \hyperlink{group__data__structures_gac8c5669d3fb813cacf506489689305ce}{vrna\-\_\-basepair\-\_\-t} $\ast$( \hyperlink{group__generalized__sc_ga1157aec50aa078464b868b5d2245ebf5}{vrna\-\_\-callback\-\_\-sc\-\_\-backtrack} )(int i, int j, int k, int l, char d, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback to retrieve auxiliary base pairs for soft constraint feature. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group__generalized__sc_ga8c7d907ec0125cd61c04e0908010a4e9}{vrna\-\_\-sc\-\_\-add\-\_\-f} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$vc, \hyperlink{group__generalized__sc_ga2f3d2d2333e5a616e0f5cd4823780c0c}{vrna\-\_\-callback\-\_\-sc\-\_\-energy} $\ast$f)
\begin{DoxyCompactList}\small\item\em Bind a function pointer for generalized soft constraint feature (M\-F\-E version) \end{DoxyCompactList}\item 
void \hyperlink{group__generalized__sc_gabde7d07a79bb9a8f4721aee247b674ea}{vrna\-\_\-sc\-\_\-add\-\_\-bt} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$vc, \hyperlink{group__generalized__sc_ga1157aec50aa078464b868b5d2245ebf5}{vrna\-\_\-callback\-\_\-sc\-\_\-backtrack} $\ast$f)
\begin{DoxyCompactList}\small\item\em Bind a backtracking function pointer for generalized soft constraint feature. \end{DoxyCompactList}\item 
void \hyperlink{group__generalized__sc_ga87e382b5d0c9b7d9ce1b79c0473ff700}{vrna\-\_\-sc\-\_\-add\-\_\-exp\-\_\-f} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$vc, \hyperlink{group__generalized__sc_ga28d5138cc47eb7a5116c87518fd076a9}{vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy} $\ast$exp\-\_\-f)
\begin{DoxyCompactList}\small\item\em Bind a function pointer for generalized soft constraint feature (P\-F version) \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__generalized__sc_gaa6ff0113a3a76dc0b8d62961f4e1dfa0}{vrna\-\_\-sc\-\_\-add\-\_\-hi\-\_\-motif} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$vc, const char $\ast$seq, const char $\ast$structure, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} energy, unsigned int options)
\begin{DoxyCompactList}\small\item\em Add soft constraints for hairpin or interior loop binding motif. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Typedef Documentation}
\hypertarget{group__generalized__sc_ga2f3d2d2333e5a616e0f5cd4823780c0c}{\index{Generalized Soft Constraints@{Generalized Soft Constraints}!vrna\-\_\-callback\-\_\-sc\-\_\-energy@{vrna\-\_\-callback\-\_\-sc\-\_\-energy}}
\index{vrna\-\_\-callback\-\_\-sc\-\_\-energy@{vrna\-\_\-callback\-\_\-sc\-\_\-energy}!Generalized Soft Constraints@{Generalized Soft Constraints}}
\subsubsection[{vrna\-\_\-callback\-\_\-sc\-\_\-energy}]{\setlength{\rightskip}{0pt plus 5cm}typedef int( vrna\-\_\-callback\-\_\-sc\-\_\-energy)(int i, int j, int k, int l, char d, void $\ast$data)}}\label{group__generalized__sc_ga2f3d2d2333e5a616e0f5cd4823780c0c}


{\ttfamily \#include $<$\hyperlink{constraints_8h}{Vienna\-R\-N\-A/constraints.\-h}$>$}



Callback to retrieve pseudo energy contribution for soft constraint feature. 


\begin{DoxyParams}{Parameters}
{\em i} & Left (5') delimiter position of substructure \\
\hline
{\em j} & Right (3') delimiter position of substructure \\
\hline
{\em k} & \\
\hline
{\em l} & \\
\hline
{\em d} & Decomposition step indicator \\
\hline
{\em data} & Auxiliary data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pseudo energy contribution in deka-\/kalories per mol 
\end{DoxyReturn}
\hypertarget{group__generalized__sc_ga28d5138cc47eb7a5116c87518fd076a9}{\index{Generalized Soft Constraints@{Generalized Soft Constraints}!vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy@{vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy}}
\index{vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy@{vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy}!Generalized Soft Constraints@{Generalized Soft Constraints}}
\subsubsection[{vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L}( vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy)(int i, int j, int k, int l, char d, void $\ast$data)}}\label{group__generalized__sc_ga28d5138cc47eb7a5116c87518fd076a9}


{\ttfamily \#include $<$\hyperlink{constraints_8h}{Vienna\-R\-N\-A/constraints.\-h}$>$}



Callback to retrieve pseudo energy contribution as Boltzmann Factors for soft constraint feature. 


\begin{DoxyParams}{Parameters}
{\em i} & Left (5') delimiter position of substructure \\
\hline
{\em j} & Right (3') delimiter position of substructure \\
\hline
{\em k} & \\
\hline
{\em l} & \\
\hline
{\em d} & Decomposition step indicator \\
\hline
{\em data} & Auxiliary data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pseudo energy contribution in deka-\/kalories per mol 
\end{DoxyReturn}
\hypertarget{group__generalized__sc_ga1157aec50aa078464b868b5d2245ebf5}{\index{Generalized Soft Constraints@{Generalized Soft Constraints}!vrna\-\_\-callback\-\_\-sc\-\_\-backtrack@{vrna\-\_\-callback\-\_\-sc\-\_\-backtrack}}
\index{vrna\-\_\-callback\-\_\-sc\-\_\-backtrack@{vrna\-\_\-callback\-\_\-sc\-\_\-backtrack}!Generalized Soft Constraints@{Generalized Soft Constraints}}
\subsubsection[{vrna\-\_\-callback\-\_\-sc\-\_\-backtrack}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf vrna\-\_\-basepair\-\_\-t}$\ast$( vrna\-\_\-callback\-\_\-sc\-\_\-backtrack)(int i, int j, int k, int l, char d, void $\ast$data)}}\label{group__generalized__sc_ga1157aec50aa078464b868b5d2245ebf5}


{\ttfamily \#include $<$\hyperlink{constraints_8h}{Vienna\-R\-N\-A/constraints.\-h}$>$}



Callback to retrieve auxiliary base pairs for soft constraint feature. 


\begin{DoxyParams}{Parameters}
{\em i} & Left (5') delimiter position of substructure \\
\hline
{\em j} & Right (3') delimiter position of substructure \\
\hline
{\em k} & \\
\hline
{\em l} & \\
\hline
{\em d} & Decomposition step indicator \\
\hline
{\em data} & Auxiliary data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
List of additional base pairs 
\end{DoxyReturn}


\subsection{Function Documentation}
\hypertarget{group__generalized__sc_ga8c7d907ec0125cd61c04e0908010a4e9}{\index{Generalized Soft Constraints@{Generalized Soft Constraints}!vrna\-\_\-sc\-\_\-add\-\_\-f@{vrna\-\_\-sc\-\_\-add\-\_\-f}}
\index{vrna\-\_\-sc\-\_\-add\-\_\-f@{vrna\-\_\-sc\-\_\-add\-\_\-f}!Generalized Soft Constraints@{Generalized Soft Constraints}}
\subsubsection[{vrna\-\_\-sc\-\_\-add\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}void vrna\-\_\-sc\-\_\-add\-\_\-f (
\begin{DoxyParamCaption}
\item[{{\bf vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$}]{vc, }
\item[{{\bf vrna\-\_\-callback\-\_\-sc\-\_\-energy} $\ast$}]{f}
\end{DoxyParamCaption}
)}}\label{group__generalized__sc_ga8c7d907ec0125cd61c04e0908010a4e9}


{\ttfamily \#include $<$\hyperlink{constraints_8h}{Vienna\-R\-N\-A/constraints.\-h}$>$}



Bind a function pointer for generalized soft constraint feature (M\-F\-E version) 

This function allows to easily bind a function pointer and corresponding data structure to the soft constraint part \hyperlink{group__constraints_ga75401ce219ef8dbcceb672db82d434c6}{vrna\-\_\-sc\-\_\-t} of the \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t}. The function for evaluating the generalized soft constraint feature has to return a pseudo free energy $ \hat{E} $ in $ dacal/mol $, where $ 1 dacal/mol = 10 cal/mol $.


\begin{DoxyParams}{Parameters}
{\em vc} & The fold compound the generalized soft constraint function should be bound to \\
\hline
{\em f} & A pointer to the function that evaluates the generalized soft constraint feature \\
\hline
{\em data} & A pointer to the data structure that holds required data for function 'f' \\
\hline
\end{DoxyParams}
\hypertarget{group__generalized__sc_gabde7d07a79bb9a8f4721aee247b674ea}{\index{Generalized Soft Constraints@{Generalized Soft Constraints}!vrna\-\_\-sc\-\_\-add\-\_\-bt@{vrna\-\_\-sc\-\_\-add\-\_\-bt}}
\index{vrna\-\_\-sc\-\_\-add\-\_\-bt@{vrna\-\_\-sc\-\_\-add\-\_\-bt}!Generalized Soft Constraints@{Generalized Soft Constraints}}
\subsubsection[{vrna\-\_\-sc\-\_\-add\-\_\-bt}]{\setlength{\rightskip}{0pt plus 5cm}void vrna\-\_\-sc\-\_\-add\-\_\-bt (
\begin{DoxyParamCaption}
\item[{{\bf vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$}]{vc, }
\item[{{\bf vrna\-\_\-callback\-\_\-sc\-\_\-backtrack} $\ast$}]{f}
\end{DoxyParamCaption}
)}}\label{group__generalized__sc_gabde7d07a79bb9a8f4721aee247b674ea}


{\ttfamily \#include $<$\hyperlink{constraints_8h}{Vienna\-R\-N\-A/constraints.\-h}$>$}



Bind a backtracking function pointer for generalized soft constraint feature. 

This function allows to easily bind a function pointer to the soft constraint part \hyperlink{group__constraints_ga75401ce219ef8dbcceb672db82d434c6}{vrna\-\_\-sc\-\_\-t} of the \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t}. The provided function should be used for backtracking purposes in loop regions that were altered via the generalized soft constraint feature. It has to return an array of \hyperlink{group__data__structures_gac8c5669d3fb813cacf506489689305ce}{vrna\-\_\-basepair\-\_\-t} data structures, were the last element in the list is indicated by a value of -\/1 in it's i position.


\begin{DoxyParams}{Parameters}
{\em vc} & The fold compound the generalized soft constraint function should be bound to \\
\hline
{\em f} & A pointer to the function that returns additional base pairs \\
\hline
\end{DoxyParams}
\hypertarget{group__generalized__sc_ga87e382b5d0c9b7d9ce1b79c0473ff700}{\index{Generalized Soft Constraints@{Generalized Soft Constraints}!vrna\-\_\-sc\-\_\-add\-\_\-exp\-\_\-f@{vrna\-\_\-sc\-\_\-add\-\_\-exp\-\_\-f}}
\index{vrna\-\_\-sc\-\_\-add\-\_\-exp\-\_\-f@{vrna\-\_\-sc\-\_\-add\-\_\-exp\-\_\-f}!Generalized Soft Constraints@{Generalized Soft Constraints}}
\subsubsection[{vrna\-\_\-sc\-\_\-add\-\_\-exp\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}void vrna\-\_\-sc\-\_\-add\-\_\-exp\-\_\-f (
\begin{DoxyParamCaption}
\item[{{\bf vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$}]{vc, }
\item[{{\bf vrna\-\_\-callback\-\_\-sc\-\_\-exp\-\_\-energy} $\ast$}]{exp\-\_\-f}
\end{DoxyParamCaption}
)}}\label{group__generalized__sc_ga87e382b5d0c9b7d9ce1b79c0473ff700}


{\ttfamily \#include $<$\hyperlink{constraints_8h}{Vienna\-R\-N\-A/constraints.\-h}$>$}



Bind a function pointer for generalized soft constraint feature (P\-F version) 

This function allows to easily bind a function pointer and corresponding data structure to the soft constraint part \hyperlink{group__constraints_ga75401ce219ef8dbcceb672db82d434c6}{vrna\-\_\-sc\-\_\-t} of the \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t}. The function for evaluating the generalized soft constraint feature has to return a pseudo free energy $ \hat{E} $ as Boltzmann factor, i.\-e. $ exp(- \hat{E} / kT) $. The required unit for $ E $ is $ cal/mol $.


\begin{DoxyParams}{Parameters}
{\em vc} & The fold compound the generalized soft constraint function should be bound to \\
\hline
{\em exp\-\_\-f} & A pointer to the function that evaluates the generalized soft constraint feature \\
\hline
{\em data} & A pointer to the data structure that holds required data for function 'f' \\
\hline
\end{DoxyParams}
\hypertarget{group__generalized__sc_gaa6ff0113a3a76dc0b8d62961f4e1dfa0}{\index{Generalized Soft Constraints@{Generalized Soft Constraints}!vrna\-\_\-sc\-\_\-add\-\_\-hi\-\_\-motif@{vrna\-\_\-sc\-\_\-add\-\_\-hi\-\_\-motif}}
\index{vrna\-\_\-sc\-\_\-add\-\_\-hi\-\_\-motif@{vrna\-\_\-sc\-\_\-add\-\_\-hi\-\_\-motif}!Generalized Soft Constraints@{Generalized Soft Constraints}}
\subsubsection[{vrna\-\_\-sc\-\_\-add\-\_\-hi\-\_\-motif}]{\setlength{\rightskip}{0pt plus 5cm}int vrna\-\_\-sc\-\_\-add\-\_\-hi\-\_\-motif (
\begin{DoxyParamCaption}
\item[{{\bf vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$}]{vc, }
\item[{const char $\ast$}]{seq, }
\item[{const char $\ast$}]{structure, }
\item[{{\bf F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L}}]{energy, }
\item[{unsigned int}]{options}
\end{DoxyParamCaption}
)}}\label{group__generalized__sc_gaa6ff0113a3a76dc0b8d62961f4e1dfa0}


{\ttfamily \#include $<$\hyperlink{ligand_8h}{Vienna\-R\-N\-A/ligand.\-h}$>$}



Add soft constraints for hairpin or interior loop binding motif. 

Here is an example that adds a theophylline binding motif. Free energy contribution is derived from $k_d = 0.32 \mu mol / l $, taken from Jenison et al. 1994 
\begin{DoxyCode}
\hyperlink{group__generalized__sc_gaa6ff0113a3a76dc0b8d62961f4e1dfa0}{vrna\_sc\_add\_hi\_motif}( vc,
                      \textcolor{stringliteral}{"GAUACCAG&CCCUUGGCAGC"},
                      \textcolor{stringliteral}{"(...((((&)...)))...)"},
                      -9.22,
                      \hyperlink{group__fold__compound_gae63be9127fe7dcc1f9bb14f5bb1064ee}{VRNA\_OPTION\_MFE}); 
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em vc} & The \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t} the motif is applied to \\
\hline
{\em seq} & The sequence motif (may be interspaced by '\&' character \\
\hline
{\em structure} & The structure motif (may be interspaced by '\&' character \\
\hline
{\em energy} & The free energy of the motif (e.\-g. binding free energy) \\
\hline
{\em options} & Options indicating whether to use the motif in M\-F\-E prediction, and/or P\-F predictions \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
non-\/zero value if application of the motif using soft constraints was successful 
\end{DoxyReturn}
