\hypertarget{group__local__pf__fold}{\section{Partition functions for locally stable secondary structures}
\label{group__local__pf__fold}\index{Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}}
}
Collaboration diagram for Partition functions for locally stable secondary structures\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{group__local__pf__fold}
\end{center}
\end{figure}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{LPfold_8h}{L\-Pfold.\-h}
\begin{DoxyCompactList}\small\item\em Function declarations of partition function variants of the Lfold algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group__local__pf__fold_ga5a019014d37fe6105131dfc2fc447880}{update\-\_\-pf\-\_\-params\-L\-P} (int length)
\item 
\hyperlink{group__data__structures_gab1d8894b43aa84cbc50b862a73785fbc}{plist} $\ast$ \hyperlink{group__local__pf__fold_ga7dcf599d07258801ea55e7d14a56908d}{pfl\-\_\-fold} (char $\ast$sequence, int win\-Size, int pair\-Size, float cutoffb, double $\ast$$\ast$p\-U, \hyperlink{group__data__structures_gab1d8894b43aa84cbc50b862a73785fbc}{plist} $\ast$$\ast$dpp2, F\-I\-L\-E $\ast$p\-Ufp, F\-I\-L\-E $\ast$spup)
\begin{DoxyCompactList}\small\item\em Compute partition functions for locally stable secondary structures. \end{DoxyCompactList}\item 
\hypertarget{group__local__pf__fold_ga14c2b82fdd5ab7a1951f1c2db4f5cf2c}{\hyperlink{group__data__structures_gab1d8894b43aa84cbc50b862a73785fbc}{plist} $\ast$ \hyperlink{group__local__pf__fold_ga14c2b82fdd5ab7a1951f1c2db4f5cf2c}{pfl\-\_\-fold\-\_\-par} (char $\ast$sequence, int win\-Size, int pair\-Size, float cutoffb, double $\ast$$\ast$p\-U, \hyperlink{group__data__structures_gab1d8894b43aa84cbc50b862a73785fbc}{plist} $\ast$$\ast$dpp2, F\-I\-L\-E $\ast$p\-Ufp, F\-I\-L\-E $\ast$spup, \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\-\_\-exp\-\_\-param\-\_\-t} $\ast$parameters)}\label{group__local__pf__fold_ga14c2b82fdd5ab7a1951f1c2db4f5cf2c}

\begin{DoxyCompactList}\small\item\em Compute partition functions for locally stable secondary structures. \end{DoxyCompactList}\item 
void \hyperlink{group__local__pf__fold_ga0bcb751860bbf34e3dfee8c2fbdb3ef3}{putoutp\-U\-\_\-prob} (double $\ast$$\ast$p\-U, int length, int ulength, F\-I\-L\-E $\ast$fp, int energies)
\begin{DoxyCompactList}\small\item\em Writes the unpaired probabilities (p\-U) or opening energies into a file. \end{DoxyCompactList}\item 
void \hyperlink{group__local__pf__fold_ga9acb00ee10e96b1ca4ea394cd8bcec75}{putoutp\-U\-\_\-prob\-\_\-bin} (double $\ast$$\ast$p\-U, int length, int ulength, F\-I\-L\-E $\ast$fp, int energies)
\begin{DoxyCompactList}\small\item\em Writes the unpaired probabilities (p\-U) or opening energies into a binary file. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Function Documentation}
\hypertarget{group__local__pf__fold_ga5a019014d37fe6105131dfc2fc447880}{\index{Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}!update\-\_\-pf\-\_\-params\-L\-P@{update\-\_\-pf\-\_\-params\-L\-P}}
\index{update\-\_\-pf\-\_\-params\-L\-P@{update\-\_\-pf\-\_\-params\-L\-P}!Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}}
\subsubsection[{update\-\_\-pf\-\_\-params\-L\-P}]{\setlength{\rightskip}{0pt plus 5cm}void update\-\_\-pf\-\_\-params\-L\-P (
\begin{DoxyParamCaption}
\item[{int}]{length}
\end{DoxyParamCaption}
)}}\label{group__local__pf__fold_ga5a019014d37fe6105131dfc2fc447880}


{\ttfamily \#include $<$\hyperlink{LPfold_8h}{Vienna\-R\-N\-A/\-L\-Pfold.\-h}$>$}


\begin{DoxyParams}{Parameters}
{\em length} & \\
\hline
\end{DoxyParams}
\hypertarget{group__local__pf__fold_ga7dcf599d07258801ea55e7d14a56908d}{\index{Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}!pfl\-\_\-fold@{pfl\-\_\-fold}}
\index{pfl\-\_\-fold@{pfl\-\_\-fold}!Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}}
\subsubsection[{pfl\-\_\-fold}]{\setlength{\rightskip}{0pt plus 5cm}{\bf plist}$\ast$ pfl\-\_\-fold (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{sequence, }
\item[{int}]{win\-Size, }
\item[{int}]{pair\-Size, }
\item[{float}]{cutoffb, }
\item[{double $\ast$$\ast$}]{p\-U, }
\item[{{\bf plist} $\ast$$\ast$}]{dpp2, }
\item[{F\-I\-L\-E $\ast$}]{p\-Ufp, }
\item[{F\-I\-L\-E $\ast$}]{spup}
\end{DoxyParamCaption}
)}}\label{group__local__pf__fold_ga7dcf599d07258801ea55e7d14a56908d}


{\ttfamily \#include $<$\hyperlink{LPfold_8h}{Vienna\-R\-N\-A/\-L\-Pfold.\-h}$>$}



Compute partition functions for locally stable secondary structures. 

pfl\-\_\-fold computes partition functions for every window of size 'win\-Size' possible in a R\-N\-A molecule, allowing only pairs with a span smaller than 'pair\-Size'. It returns the mean pair probabilities averaged over all windows containing the pair in 'pl'. 'win\-Size' should always be $>$= 'pair\-Size'. Note that in contrast to \hyperlink{group__local__mfe__fold_ga16e5a70e60835bb969eaecbe6482f1be}{Lfold()}, bases outside of the window do not influence the structure at all. Only probabilities higher than 'cutoffb' are kept.

If 'p\-U' is supplied (i.\-e is not the N\-U\-L\-L pointer), \hyperlink{group__local__pf__fold_ga7dcf599d07258801ea55e7d14a56908d}{pfl\-\_\-fold()} will also compute the mean probability that regions of length 'u' and smaller are unpaired. The parameter 'u' is supplied in 'pup\mbox{[}0\mbox{]}\mbox{[}0\mbox{]}'. On return the 'pup' array will contain these probabilities, with the entry on 'pup\mbox{[}x\mbox{]}\mbox{[}y\mbox{]}' containing the mean probability that x and the y-\/1 preceding bases are unpaired. The 'p\-U' array needs to be large enough to hold n+1 float$\ast$ entries, where n is the sequence length.

If an array dpp2 is supplied, the probability of base pair (i,j) given that there already exists a base pair (i+1,j-\/1) is also computed and saved in this array. If p\-Ufp is given (i.\-e. not N\-U\-L\-L), p\-U is not saved but put out imediately. If spup is given (i.\-e. is not N\-U\-L\-L), the pair probabilities in pl are not saved but put out imediately.


\begin{DoxyParams}{Parameters}
{\em sequence} & R\-N\-A sequence \\
\hline
{\em win\-Size} & size of the window \\
\hline
{\em pair\-Size} & maximum size of base pair \\
\hline
{\em cutoffb} & cutoffb for base pairs \\
\hline
{\em p\-U} & array holding all unpaired probabilities \\
\hline
{\em dpp2} & array of dependent pair probabilities \\
\hline
{\em p\-Ufp} & file pointer for p\-U \\
\hline
{\em spup} & file pointer for pair probabilities \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
list of pair probabilities 
\end{DoxyReturn}
\hypertarget{group__local__pf__fold_ga0bcb751860bbf34e3dfee8c2fbdb3ef3}{\index{Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}!putoutp\-U\-\_\-prob@{putoutp\-U\-\_\-prob}}
\index{putoutp\-U\-\_\-prob@{putoutp\-U\-\_\-prob}!Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}}
\subsubsection[{putoutp\-U\-\_\-prob}]{\setlength{\rightskip}{0pt plus 5cm}void putoutp\-U\-\_\-prob (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{p\-U, }
\item[{int}]{length, }
\item[{int}]{ulength, }
\item[{F\-I\-L\-E $\ast$}]{fp, }
\item[{int}]{energies}
\end{DoxyParamCaption}
)}}\label{group__local__pf__fold_ga0bcb751860bbf34e3dfee8c2fbdb3ef3}


{\ttfamily \#include $<$\hyperlink{LPfold_8h}{Vienna\-R\-N\-A/\-L\-Pfold.\-h}$>$}



Writes the unpaired probabilities (p\-U) or opening energies into a file. 

Can write either the unpaired probabilities (accessibilities) p\-U or the opening energies -\/log(p\-U)k\-T into a file


\begin{DoxyParams}{Parameters}
{\em p\-U} & pair probabilities \\
\hline
{\em length} & length of R\-N\-A sequence \\
\hline
{\em ulength} & maximum length of unpaired stretch \\
\hline
{\em fp} & file pointer of destination file \\
\hline
{\em energies} & switch to put out as opening energies \\
\hline
\end{DoxyParams}
\hypertarget{group__local__pf__fold_ga9acb00ee10e96b1ca4ea394cd8bcec75}{\index{Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}!putoutp\-U\-\_\-prob\-\_\-bin@{putoutp\-U\-\_\-prob\-\_\-bin}}
\index{putoutp\-U\-\_\-prob\-\_\-bin@{putoutp\-U\-\_\-prob\-\_\-bin}!Partition functions for locally stable secondary structures@{Partition functions for locally stable secondary structures}}
\subsubsection[{putoutp\-U\-\_\-prob\-\_\-bin}]{\setlength{\rightskip}{0pt plus 5cm}void putoutp\-U\-\_\-prob\-\_\-bin (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{p\-U, }
\item[{int}]{length, }
\item[{int}]{ulength, }
\item[{F\-I\-L\-E $\ast$}]{fp, }
\item[{int}]{energies}
\end{DoxyParamCaption}
)}}\label{group__local__pf__fold_ga9acb00ee10e96b1ca4ea394cd8bcec75}


{\ttfamily \#include $<$\hyperlink{LPfold_8h}{Vienna\-R\-N\-A/\-L\-Pfold.\-h}$>$}



Writes the unpaired probabilities (p\-U) or opening energies into a binary file. 

Can write either the unpaired probabilities (accessibilities) p\-U or the opening energies -\/log(p\-U)k\-T into a file


\begin{DoxyParams}{Parameters}
{\em p\-U} & pair probabilities \\
\hline
{\em length} & length of R\-N\-A sequence \\
\hline
{\em ulength} & maximum length of unpaired stretch \\
\hline
{\em fp} & file pointer of destination file \\
\hline
{\em energies} & switch to put out as opening energies \\
\hline
\end{DoxyParams}
