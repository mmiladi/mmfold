\hypertarget{multibranch__loops_8h}{\section{multibranch\-\_\-loops.\-h}
\label{multibranch__loops_8h}\index{Vienna\-R\-N\-A/multibranch\-\_\-loops.\-h@{Vienna\-R\-N\-A/multibranch\-\_\-loops.\-h}}
}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#ifndef VIENNA\_RNA\_PACKAGE\_MULTIBRANCH\_LOOPS\_H}
00002 \textcolor{preprocessor}{}\textcolor{preprocessor}{#define VIENNA\_RNA\_PACKAGE\_MULTIBRANCH\_LOOPS\_H}
00003 \textcolor{preprocessor}{}
00004 \textcolor{preprocessor}{#include <\hyperlink{utils_8h}{ViennaRNA/utils.h}>}
00005 \textcolor{preprocessor}{#include <\hyperlink{data__structures_8h}{ViennaRNA/data\_structures.h}>}
00006 \textcolor{preprocessor}{#include <\hyperlink{params_8h}{ViennaRNA/params.h}>}
00007 
00008 \textcolor{preprocessor}{#ifdef \_\_GNUC\_\_}
00009 \textcolor{preprocessor}{}\textcolor{preprocessor}{# define INLINE inline}
00010 \textcolor{preprocessor}{}\textcolor{preprocessor}{#else}
00011 \textcolor{preprocessor}{}\textcolor{preprocessor}{# define INLINE}
00012 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif}
00013 \textcolor{preprocessor}{}
00042 PRIVATE INLINE \textcolor{keywordtype}{int} E\_MLstem( \textcolor{keywordtype}{int} type,
00043                               \textcolor{keywordtype}{int} si1,
00044                               \textcolor{keywordtype}{int} sj1,
00045                               \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P);
00046 
00053 PRIVATE INLINE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} exp\_E\_MLstem(\textcolor{keywordtype}{int} type,
00054                                     \textcolor{keywordtype}{int} si1,
00055                                     \textcolor{keywordtype}{int} sj1,
00056                                     \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *P);
00057 
00058 
00059 
00065 \textcolor{keywordtype}{int} \hyperlink{group__loops_ga81d73d23f480f84df8cfd0042c032503}{E\_mb\_loop\_stack}(\textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} j, \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00066 
00082 \textcolor{keywordtype}{int}
00083 \hyperlink{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}{vrna\_BT\_mb\_loop}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00084                 \textcolor{keywordtype}{int} *i,
00085                 \textcolor{keywordtype}{int} *j,
00086                 \textcolor{keywordtype}{int} *k,
00087                 \textcolor{keywordtype}{int} en,
00088                 \textcolor{keywordtype}{int} *component1,
00089                 \textcolor{keywordtype}{int} *component2);
00090 
00091 \textcolor{comment}{/*}
00092 \textcolor{comment}{#################################}
00093 \textcolor{comment}{# BEGIN OF FUNCTION DEFINITIONS #}
00094 \textcolor{comment}{#################################}
00095 \textcolor{comment}{*/}
00096 
00097 
00098 \textcolor{keywordtype}{int}
00099 E\_mb\_loop\_fast( \textcolor{keywordtype}{int} i,
00100                 \textcolor{keywordtype}{int} j,
00101                 \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00102                 \textcolor{keywordtype}{int} *dmli1,
00103                 \textcolor{keywordtype}{int} *dmli2);
00104 
00105 \textcolor{keywordtype}{int}
00106 \hyperlink{group__loops_ga81d73d23f480f84df8cfd0042c032503}{E\_mb\_loop\_stack}(\textcolor{keywordtype}{int} i,
00107                 \textcolor{keywordtype}{int} j,
00108                 \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00109 
00110 \textcolor{keywordtype}{int}
00111 E\_ml\_rightmost\_stem(\textcolor{keywordtype}{int} i,
00112                     \textcolor{keywordtype}{int} j,
00113                     \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00114 
00115 
00116 \textcolor{keywordtype}{int}
00117 E\_ml\_stems\_fast(\textcolor{keywordtype}{int} i,
00118                 \textcolor{keywordtype}{int} j,
00119                 \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00120                 \textcolor{keywordtype}{int} *fmi,
00121                 \textcolor{keywordtype}{int} *dmli);
00122 
00123 PRIVATE INLINE \textcolor{keywordtype}{int} E\_MLstem(\textcolor{keywordtype}{int} type, \textcolor{keywordtype}{int} si1, \textcolor{keywordtype}{int} sj1, \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P)\{
00124   \textcolor{keywordtype}{int} energy = 0;
00125   \textcolor{keywordflow}{if}(si1 >= 0 && sj1 >= 0)\{
00126     energy += P->mismatchM[type][si1][sj1];
00127   \}
00128   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (si1 >= 0)\{
00129     energy += P->dangle5[type][si1];
00130   \}
00131   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sj1 >= 0)\{
00132     energy += P->dangle3[type][sj1];
00133   \}
00134 
00135   \textcolor{keywordflow}{if}(type > 2)
00136     energy += P->TerminalAU;
00137 
00138   energy += P->MLintern[type];
00139 
00140   \textcolor{keywordflow}{return} energy;
00141 \}
00142 
00143 
00144 
00145 PRIVATE INLINE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00146 exp\_E\_MLstem( \textcolor{keywordtype}{int} type,
00147               \textcolor{keywordtype}{int} si1,
00148               \textcolor{keywordtype}{int} sj1,
00149               \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *P)\{
00150 
00151   \textcolor{keywordtype}{double} energy = 1.0;
00152   \textcolor{keywordflow}{if}(si1 >= 0 && sj1 >= 0)\{
00153     energy = P->expmismatchM[type][si1][sj1];
00154   \}
00155   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(si1 >= 0)\{
00156     energy = P->expdangle5[type][si1];
00157   \}
00158   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(sj1 >= 0)\{
00159     energy = P->expdangle3[type][sj1];
00160   \}
00161 
00162   \textcolor{keywordflow}{if}(type > 2)
00163     energy *= P->expTermAU;
00164 
00165   energy *= P->expMLintern[type];
00166   \textcolor{keywordflow}{return} (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})energy;
00167 \}
00168 
00169 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00170 vrna\_exp\_E\_mb\_loop\_fast( \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00171                     \textcolor{keywordtype}{int} i,
00172                     \textcolor{keywordtype}{int} j,
00173                     \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} *qqm1);
00174 
00175 
00176 
00177 \textcolor{comment}{/*}
00178 \textcolor{comment}{#################################}
00179 \textcolor{comment}{# Backtracking functions below  #}
00180 \textcolor{comment}{#################################}
00181 \textcolor{comment}{*/}
00182 
00183 \textcolor{keywordtype}{int}
00184 vrna\_BT\_mb\_loop\_fake( \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00185                       \textcolor{keywordtype}{int} *u,
00186                       \textcolor{keywordtype}{int} *i,
00187                       \textcolor{keywordtype}{int} *j,
00188                       \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp\_stack,
00189                       \textcolor{keywordtype}{int} *stack\_count);
00190 
00191 \textcolor{keywordtype}{int}
00192 vrna\_BT\_mb\_loop\_split(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00193                       \textcolor{keywordtype}{int} *i,
00194                       \textcolor{keywordtype}{int} *j,
00195                       \textcolor{keywordtype}{int} *k,
00196                       \textcolor{keywordtype}{int} *l,
00197                       \textcolor{keywordtype}{int} *component1,
00198                       \textcolor{keywordtype}{int} *component2,
00199                       \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp\_stack,
00200                       \textcolor{keywordtype}{int} *stack\_count);
00201 
00202 \textcolor{keywordtype}{int}
00203 \hyperlink{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}{vrna\_BT\_mb\_loop}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00204                 \textcolor{keywordtype}{int} *i,
00205                 \textcolor{keywordtype}{int} *j,
00206                 \textcolor{keywordtype}{int} *k,
00207                 \textcolor{keywordtype}{int} en,
00208                 \textcolor{keywordtype}{int} *component1,
00209                 \textcolor{keywordtype}{int} *component2);
00210 
00215 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
