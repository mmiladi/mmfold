\hypertarget{part__func_8h}{\section{Vienna\-R\-N\-A/part\-\_\-func.h File Reference}
\label{part__func_8h}\index{Vienna\-R\-N\-A/part\-\_\-func.\-h@{Vienna\-R\-N\-A/part\-\_\-func.\-h}}
}


Partition function of single R\-N\-A sequences.  


Include dependency graph for part\-\_\-func.\-h\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{part__func_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=198pt]{part__func_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
float \hyperlink{group__pf__fold_ga29e256d688ad221b78d37f427e0e99bc}{vrna\-\_\-pf} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$vc, char $\ast$structure)
\begin{DoxyCompactList}\small\item\em Compute the partition function $Q$ for a given R\-N\-A sequence, or sequence alignment. \end{DoxyCompactList}\item 
float \hyperlink{group__pf__fold_ga59935ba485ac90f0efb5a38e2962d879}{vrna\-\_\-pf\-\_\-fold} (const char $\ast$seq, char $\ast$structure, \hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\-\_\-plist\-\_\-t} $\ast$$\ast$pl)
\begin{DoxyCompactList}\small\item\em Compute Partition function $Q$ (and base pair probabilities) for an R\-N\-A sequence using a comparative method. \end{DoxyCompactList}\item 
float \hyperlink{group__pf__fold_ga6dc133fce577fc0370986f3a3301cd10}{vrna\-\_\-pf\-\_\-circfold} (const char $\ast$seq, char $\ast$structure, \hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\-\_\-plist\-\_\-t} $\ast$$\ast$pl)
\begin{DoxyCompactList}\small\item\em Compute Partition function $Q$ (and base pair probabilities) for a circular R\-N\-A sequences using a comparative method. \end{DoxyCompactList}\item 
int \hyperlink{part__func_8h_ad2b3594f0b50b68029e0f54fdce59313}{vrna\-\_\-pf\-\_\-float\-\_\-precision} (void)
\begin{DoxyCompactList}\small\item\em Find out whether partition function computations are using single precision floating points. \end{DoxyCompactList}\item 
double \hyperlink{group__pf__fold_gad3f0c240512e6d43e2e4d4c2076021f5}{vrna\-\_\-mean\-\_\-bp\-\_\-distance\-\_\-pr} (int length, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} $\ast$\hyperlink{fold__vars_8h_ac98ec419070aee6831b44e5c700f090f}{pr})
\begin{DoxyCompactList}\small\item\em Get the mean base pair distance in the thermodynamic ensemble from a probability matrix. \end{DoxyCompactList}\item 
double \hyperlink{group__pf__fold_gaa6b8983b559b9ef4b2e1b31113ea317b}{vrna\-\_\-mean\-\_\-bp\-\_\-distance} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$vc)
\begin{DoxyCompactList}\small\item\em Get the mean base pair distance in the thermodynamic ensemble. \end{DoxyCompactList}\item 
\hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\-\_\-plist\-\_\-t} $\ast$ \hyperlink{group__pf__fold_ga26e3cc2eb127a35625572e9275c24ee4}{vrna\-\_\-stack\-\_\-prob} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\-\_\-fold\-\_\-compound\-\_\-t} $\ast$vc, double cutoff)
\begin{DoxyCompactList}\small\item\em Compute stacking probabilities. \end{DoxyCompactList}\item 
float \hyperlink{group__pf__fold_gac4f95bee734b2563a3d6e9932117ebdf}{pf\-\_\-fold\-\_\-par} (const char $\ast$sequence, char $\ast$structure, \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\-\_\-exp\-\_\-param\-\_\-t} $\ast$parameters, int calculate\-\_\-bppm, int is\-\_\-constrained, int is\-\_\-circular)
\begin{DoxyCompactList}\small\item\em Compute the partition function $Q$ for a given R\-N\-A sequence. \end{DoxyCompactList}\item 
float \hyperlink{group__pf__fold_gadc3db3d98742427e7001a7fd36ef28c2}{pf\-\_\-fold} (const char $\ast$sequence, char $\ast$structure)
\begin{DoxyCompactList}\small\item\em Compute the partition function $Q$ of an R\-N\-A sequence. \end{DoxyCompactList}\item 
float \hyperlink{group__pf__fold_ga819ce5fca8984004ac81c4a3b04cb735}{pf\-\_\-circ\-\_\-fold} (const char $\ast$sequence, char $\ast$structure)
\begin{DoxyCompactList}\small\item\em Compute the partition function of a circular R\-N\-A sequence. \end{DoxyCompactList}\item 
char $\ast$ \hyperlink{group__subopt__stochbt_gac03ca6db186bb3bf0a2a326d7fb3ba03}{pbacktrack} (char $\ast$sequence)
\begin{DoxyCompactList}\small\item\em Sample a secondary structure from the Boltzmann ensemble according its probability. \end{DoxyCompactList}\item 
char $\ast$ \hyperlink{group__subopt__stochbt_ga00474051204ac9ad576b3e45174d03ff}{pbacktrack\-\_\-circ} (char $\ast$sequence)
\begin{DoxyCompactList}\small\item\em Sample a secondary structure of a circular R\-N\-A from the Boltzmann ensemble according its probability. \end{DoxyCompactList}\item 
void \hyperlink{group__pf__fold_gae73db3f49a94f0f72e067ecd12681dbd}{free\-\_\-pf\-\_\-arrays} (void)
\begin{DoxyCompactList}\small\item\em Free arrays for the partition function recursions. \end{DoxyCompactList}\item 
void \hyperlink{group__pf__fold_ga384e927890f9c034ff09fa66da102d28}{update\-\_\-pf\-\_\-params} (int length)
\begin{DoxyCompactList}\small\item\em Recalculate energy parameters. \end{DoxyCompactList}\item 
void \hyperlink{group__pf__fold_gaafe2d1b21f5418b123b088aa395e827d}{update\-\_\-pf\-\_\-params\-\_\-par} (int length, \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\-\_\-exp\-\_\-param\-\_\-t} $\ast$parameters)
\begin{DoxyCompactList}\small\item\em Recalculate energy parameters. \end{DoxyCompactList}\item 
\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} $\ast$ \hyperlink{group__pf__fold_gac5ac7ee281aae1c5cc5898a841178073}{export\-\_\-bppm} (void)
\begin{DoxyCompactList}\small\item\em Get a pointer to the base pair probability array

Accessing the base pair probabilities for a pair (i,j) is achieved by. \end{DoxyCompactList}\item 
int \hyperlink{group__pf__fold_ga42faebdfce6f070c5f89adfc8427525c}{get\-\_\-pf\-\_\-arrays} (short $\ast$$\ast$S\-\_\-p, short $\ast$$\ast$S1\-\_\-p, char $\ast$$\ast$ptype\-\_\-p, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} $\ast$$\ast$qb\-\_\-p, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} $\ast$$\ast$qm\-\_\-p, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} $\ast$$\ast$q1k\-\_\-p, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} $\ast$$\ast$qln\-\_\-p)
\begin{DoxyCompactList}\small\item\em Get the pointers to (almost) all relavant computation arrays used in partition function computation. \end{DoxyCompactList}\item 
\hypertarget{part__func_8h_a189e2a1ec6cc32c53ea72f7543b0441e}{double \hyperlink{part__func_8h_a189e2a1ec6cc32c53ea72f7543b0441e}{get\-\_\-subseq\-\_\-\-F} (int i, int j)}\label{part__func_8h_a189e2a1ec6cc32c53ea72f7543b0441e}

\begin{DoxyCompactList}\small\item\em Get the free energy of a subsequence from the q\mbox{[}\mbox{]} array. \end{DoxyCompactList}\item 
double \hyperlink{group__pf__fold_ga79cbc375af65f11609feb6b055269e7d}{mean\-\_\-bp\-\_\-distance} (int length)
\begin{DoxyCompactList}\small\item\em Get the mean base pair distance of the last partition function computation. \end{DoxyCompactList}\item 
double \hyperlink{group__pf__fold_gad5ba36cef8d01cf4244cc09b9bf1ce1d}{mean\-\_\-bp\-\_\-distance\-\_\-pr} (int length, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} $\ast$\hyperlink{fold__vars_8h_ac98ec419070aee6831b44e5c700f090f}{pr})
\begin{DoxyCompactList}\small\item\em Get the mean base pair distance in the thermodynamic ensemble. \end{DoxyCompactList}\item 
\hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\-\_\-plist\-\_\-t} $\ast$ \hyperlink{part__func_8h_ae856dd7a8d75c471c07153882bf1db48}{stack\-Prob} (double cutoff)
\begin{DoxyCompactList}\small\item\em Get the probability of stacks. \end{DoxyCompactList}\item 
void \hyperlink{part__func_8h_a15176e23eceeff8c7d14eabcfec8a2af}{init\-\_\-pf\-\_\-fold} (int length)
\begin{DoxyCompactList}\small\item\em Allocate space for \hyperlink{group__pf__fold_gadc3db3d98742427e7001a7fd36ef28c2}{pf\-\_\-fold()} \end{DoxyCompactList}\item 
char $\ast$ \hyperlink{part__func_8h_ae89a63bd83e75a80b2ba36d20b31ce81}{centroid} (int length, double $\ast$dist)
\item 
char $\ast$ \hyperlink{part__func_8h_a4e99e951dfdc006fe56c3a59374378ed}{get\-\_\-centroid\-\_\-struct\-\_\-gquad\-\_\-pr} (int length, double $\ast$dist)
\item 
double \hyperlink{part__func_8h_ae9556ba7ded44fe2321b6f67c3fc02a3}{mean\-\_\-bp\-\_\-dist} (int length)
\item 
double \hyperlink{part__func_8h_a68ba6f3a48e08ca131ab54621ce3a2d7}{exp\-Loop\-Energy} (int u1, int u2, int type, int type2, short si1, short sj1, short sp1, short sq1)
\item 
double \hyperlink{part__func_8h_a7b6ab474cc80accc48010ccfcc59f96b}{exp\-Hairpin\-Energy} (int u, int type, short si1, short sj1, const char $\ast$string)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__subopt__stochbt_gacd79b1a570e6ad9be24cb11fe8cae30a}{st\-\_\-back}
\begin{DoxyCompactList}\small\item\em Flag indicating that auxilary arrays are needed throughout the computations. This is essential for stochastic backtracking. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Partition function of single R\-N\-A sequences. This file includes (almost) all function declarations within the {\bfseries R\-N\-Alib} that are related to Partion function folding... 

\subsection{Function Documentation}
\hypertarget{part__func_8h_ad2b3594f0b50b68029e0f54fdce59313}{\index{part\-\_\-func.\-h@{part\-\_\-func.\-h}!vrna\-\_\-pf\-\_\-float\-\_\-precision@{vrna\-\_\-pf\-\_\-float\-\_\-precision}}
\index{vrna\-\_\-pf\-\_\-float\-\_\-precision@{vrna\-\_\-pf\-\_\-float\-\_\-precision}!part_func.h@{part\-\_\-func.\-h}}
\subsubsection[{vrna\-\_\-pf\-\_\-float\-\_\-precision}]{\setlength{\rightskip}{0pt plus 5cm}int vrna\-\_\-pf\-\_\-float\-\_\-precision (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{part__func_8h_ad2b3594f0b50b68029e0f54fdce59313}


Find out whether partition function computations are using single precision floating points. 

\begin{DoxySeeAlso}{See Also}
\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\-L\-T\-\_\-\-O\-R\-\_\-\-D\-B\-L} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
1 if single precision is used, 0 otherwise 
\end{DoxyReturn}
\hypertarget{part__func_8h_ae856dd7a8d75c471c07153882bf1db48}{\index{part\-\_\-func.\-h@{part\-\_\-func.\-h}!stack\-Prob@{stack\-Prob}}
\index{stack\-Prob@{stack\-Prob}!part_func.h@{part\-\_\-func.\-h}}
\subsubsection[{stack\-Prob}]{\setlength{\rightskip}{0pt plus 5cm}{\bf vrna\-\_\-plist\-\_\-t}$\ast$ stack\-Prob (
\begin{DoxyParamCaption}
\item[{double}]{cutoff}
\end{DoxyParamCaption}
)}}\label{part__func_8h_ae856dd7a8d75c471c07153882bf1db48}


Get the probability of stacks. 

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000102}{Deprecated}]Use \hyperlink{group__pf__fold_ga26e3cc2eb127a35625572e9275c24ee4}{vrna\-\_\-stack\-\_\-prob()} instead! \end{DoxyRefDesc}
\hypertarget{part__func_8h_a15176e23eceeff8c7d14eabcfec8a2af}{\index{part\-\_\-func.\-h@{part\-\_\-func.\-h}!init\-\_\-pf\-\_\-fold@{init\-\_\-pf\-\_\-fold}}
\index{init\-\_\-pf\-\_\-fold@{init\-\_\-pf\-\_\-fold}!part_func.h@{part\-\_\-func.\-h}}
\subsubsection[{init\-\_\-pf\-\_\-fold}]{\setlength{\rightskip}{0pt plus 5cm}void init\-\_\-pf\-\_\-fold (
\begin{DoxyParamCaption}
\item[{int}]{length}
\end{DoxyParamCaption}
)}}\label{part__func_8h_a15176e23eceeff8c7d14eabcfec8a2af}


Allocate space for \hyperlink{group__pf__fold_gadc3db3d98742427e7001a7fd36ef28c2}{pf\-\_\-fold()} 

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000103}{Deprecated}]This function is obsolete and will be removed soon! \end{DoxyRefDesc}
\hypertarget{part__func_8h_ae89a63bd83e75a80b2ba36d20b31ce81}{\index{part\-\_\-func.\-h@{part\-\_\-func.\-h}!centroid@{centroid}}
\index{centroid@{centroid}!part_func.h@{part\-\_\-func.\-h}}
\subsubsection[{centroid}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ centroid (
\begin{DoxyParamCaption}
\item[{int}]{length, }
\item[{double $\ast$}]{dist}
\end{DoxyParamCaption}
)}}\label{part__func_8h_ae89a63bd83e75a80b2ba36d20b31ce81}
\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000104}{Deprecated}]This function is deprecated and should not be used anymore as it is not threadsafe! \begin{DoxySeeAlso}{See Also}
\hyperlink{centroid_8h_a8f387bf1583fb5eaf5f4ffd78493e43e}{get\-\_\-centroid\-\_\-struct\-\_\-pl()}, \hyperlink{centroid_8h_ac92486ce514677256f4a832dc518759c}{get\-\_\-centroid\-\_\-struct\-\_\-pr()} 
\end{DoxySeeAlso}
\end{DoxyRefDesc}
\hypertarget{part__func_8h_a4e99e951dfdc006fe56c3a59374378ed}{\index{part\-\_\-func.\-h@{part\-\_\-func.\-h}!get\-\_\-centroid\-\_\-struct\-\_\-gquad\-\_\-pr@{get\-\_\-centroid\-\_\-struct\-\_\-gquad\-\_\-pr}}
\index{get\-\_\-centroid\-\_\-struct\-\_\-gquad\-\_\-pr@{get\-\_\-centroid\-\_\-struct\-\_\-gquad\-\_\-pr}!part_func.h@{part\-\_\-func.\-h}}
\subsubsection[{get\-\_\-centroid\-\_\-struct\-\_\-gquad\-\_\-pr}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ get\-\_\-centroid\-\_\-struct\-\_\-gquad\-\_\-pr (
\begin{DoxyParamCaption}
\item[{int}]{length, }
\item[{double $\ast$}]{dist}
\end{DoxyParamCaption}
)}}\label{part__func_8h_a4e99e951dfdc006fe56c3a59374378ed}
\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000105}{Deprecated}]This function is deprecated and should not be used anymore as it is not threadsafe! \begin{DoxySeeAlso}{See Also}
\hyperlink{group__centroid__fold_ga0e64bb67e51963dc71cbd4d30b80a018}{vrna\-\_\-centroid()}, \hyperlink{group__centroid__fold_ga98193ede06778a9ea966cc8fc43d0804}{vrna\-\_\-centroid\-\_\-from\-\_\-probs()}, \hyperlink{group__centroid__fold_ga70525a53b879c1427f9ea546c96fa1c5}{vrna\-\_\-centroid\-\_\-from\-\_\-plist()} 
\end{DoxySeeAlso}
\end{DoxyRefDesc}
\hypertarget{part__func_8h_ae9556ba7ded44fe2321b6f67c3fc02a3}{\index{part\-\_\-func.\-h@{part\-\_\-func.\-h}!mean\-\_\-bp\-\_\-dist@{mean\-\_\-bp\-\_\-dist}}
\index{mean\-\_\-bp\-\_\-dist@{mean\-\_\-bp\-\_\-dist}!part_func.h@{part\-\_\-func.\-h}}
\subsubsection[{mean\-\_\-bp\-\_\-dist}]{\setlength{\rightskip}{0pt plus 5cm}double mean\-\_\-bp\-\_\-dist (
\begin{DoxyParamCaption}
\item[{int}]{length}
\end{DoxyParamCaption}
)}}\label{part__func_8h_ae9556ba7ded44fe2321b6f67c3fc02a3}
get the mean pair distance of ensemble

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000106}{Deprecated}]This function is not threadsafe and should not be used anymore. Use \hyperlink{group__pf__fold_ga79cbc375af65f11609feb6b055269e7d}{mean\-\_\-bp\-\_\-distance()} instead! \end{DoxyRefDesc}
\hypertarget{part__func_8h_a68ba6f3a48e08ca131ab54621ce3a2d7}{\index{part\-\_\-func.\-h@{part\-\_\-func.\-h}!exp\-Loop\-Energy@{exp\-Loop\-Energy}}
\index{exp\-Loop\-Energy@{exp\-Loop\-Energy}!part_func.h@{part\-\_\-func.\-h}}
\subsubsection[{exp\-Loop\-Energy}]{\setlength{\rightskip}{0pt plus 5cm}double exp\-Loop\-Energy (
\begin{DoxyParamCaption}
\item[{int}]{u1, }
\item[{int}]{u2, }
\item[{int}]{type, }
\item[{int}]{type2, }
\item[{short}]{si1, }
\item[{short}]{sj1, }
\item[{short}]{sp1, }
\item[{short}]{sq1}
\end{DoxyParamCaption}
)}}\label{part__func_8h_a68ba6f3a48e08ca131ab54621ce3a2d7}
\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000107}{Deprecated}]Use \hyperlink{group__loops_ga34e8abb9e1b54fab38524fb20214a43e}{exp\-\_\-\-E\-\_\-\-Int\-Loop()} from \hyperlink{loop__energies_8h}{loop\-\_\-energies.\-h} instead \end{DoxyRefDesc}
\hypertarget{part__func_8h_a7b6ab474cc80accc48010ccfcc59f96b}{\index{part\-\_\-func.\-h@{part\-\_\-func.\-h}!exp\-Hairpin\-Energy@{exp\-Hairpin\-Energy}}
\index{exp\-Hairpin\-Energy@{exp\-Hairpin\-Energy}!part_func.h@{part\-\_\-func.\-h}}
\subsubsection[{exp\-Hairpin\-Energy}]{\setlength{\rightskip}{0pt plus 5cm}double exp\-Hairpin\-Energy (
\begin{DoxyParamCaption}
\item[{int}]{u, }
\item[{int}]{type, }
\item[{short}]{si1, }
\item[{short}]{sj1, }
\item[{const char $\ast$}]{string}
\end{DoxyParamCaption}
)}}\label{part__func_8h_a7b6ab474cc80accc48010ccfcc59f96b}
\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000108}{Deprecated}]Use \hyperlink{group__loops_ga51fb555974f180b78d76142b2894851c}{exp\-\_\-\-E\-\_\-\-Hairpin()} from \hyperlink{loop__energies_8h}{loop\-\_\-energies.\-h} instead \end{DoxyRefDesc}
